(LETREC INVALL
  (INVALL LAMBDA (L)
    (IF (EQ L (QUOTE NIL))
        (QUOTE NIL)
        (IF (ATOM (CAR L))
            (APPEND (INVALL (CDR L))
                    (CONS (CAR L) (QUOTE NIL))
            )
            (APPEND (INVALL (CDR L))
                    (CONS (INVALL (CAR L)) (QUOTE NIL))
            )
        )
    )
  )
  (APPEND LAMBDA (A B)
    (IF (EQ A (QUOTE NIL))
        B
        (CONS (CAR A) (APPEND (CDR A) B))
    )
  )
)